{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##problem\n",
    "1. as a doctor I need to be able easily see where my team is on a weekly basis \n",
    "2. as a doctor with responsibility for the weekly rota I need a way of generating a weekly view from the the master rota that is robust and time efficient\n",
    "n.b the current approach of manually creating a weekly view of the master rota is prone to transcription error and a waste of clinical time\n",
    "\n",
    "##approach\n",
    "1. automate the task of creating a weekly view of the master rota with python\n",
    "2. longer term, maybe a giant excel spreadsheet isn't the optimal master rota solution?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import datetime\n",
    "import collections"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def next_weekday(d, weekday):\n",
    "    days_ahead = weekday - d.weekday()\n",
    "    if days_ahead <= 0: # Target day already happened this week\n",
    "        days_ahead += 7\n",
    "        return d + datetime.timedelta(days_ahead)\n",
    "    \n",
    "def next_week(df):\n",
    "    d = datetime.date.today()\n",
    "    next_monday = next_weekday(d, 0) # 0 = Monday, 1=Tuesday, 2=Wednesday...\n",
    "    following_monday = next_monday + datetime.timedelta(13)\n",
    "    weekly_rota = df[next_monday:following_monday] #next 2 weeks cut\n",
    "    return weekly_rota\n",
    "\n",
    "def load_master_rota():\n",
    "    master_rota = 'data/wota.xlsx'\n",
    "\n",
    "    cols = range(0,45)\n",
    "    df = pd.read_excel(master_rota, dayfirst=True, skiprows=1340, usecols=cols) #load our spreadsheet\n",
    "    \n",
    "    current_cols = ['Date', 'Day', 'Notes', 'ConsOnCallNote1', 'ConsOnCallNote2', 'First Floor Consultant', 'Manvers Consultant', \n",
    "		     'CXH AMT', '4S CXH', 'HH referrals',\n",
    "                'MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', 'GR', 'LM',\n",
    "                'Date1', 'Day1', 'SprNote1', 'SprNote2', 'NoReg1', 'NoReg2', 'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Date2', 'Day2', 'Jennifer', 'Louis', 'Chinonso', 'NoSHO1', 'NoSHO2', 'NoSHO3', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne'] #define column headings\n",
    "\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "\n",
    "    assert len(df.columns) == len(current_cols) #sanity check\n",
    "\n",
    "    df.columns = current_cols #set our column names\n",
    "\n",
    "    df = df[['Date', 'Day', 'First Floor Consultant', 'Manvers Consultant', \n",
    "                'MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', 'GR', 'LM',\n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']]  #throw away columns we don't need\n",
    "\n",
    "    df.index = df.Date #lets index on the date because its better that way\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def FirstFloorReg(df):\n",
    "    FirstFloorReg = {}\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for registrar in reg:\n",
    "            if df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('1'))].any():\n",
    "                FirstFloorReg[d] = registrar \n",
    "            elif df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('PT'))].any():\n",
    "                FirstFloorReg[d] = registrar + '(post-take)'\n",
    "            elif df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('Take'))].any():\n",
    "                FirstFloorReg[d] = registrar + '(on-call)'\n",
    "                \n",
    "    return FirstFloorReg\n",
    "\n",
    "def FirstFloorJunior(df):\n",
    "    FirstFloorJunior = {}\n",
    "    juniors = ['Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for junior in juniors:\n",
    "            if df[d:d][junior][(df[d:d][junior].astype(str).str.contains('1'))].any():\n",
    "                if d.to_pydatetime() in FirstFloorJunior:\n",
    "                    FirstFloorJunior[d.to_pydatetime()].append(junior)\n",
    "                else:\n",
    "                    FirstFloorJunior[d.to_pydatetime()] = [junior]\n",
    "            elif df[d:d][junior][(df[d:d][junior].astype(str).str.contains('PT'))].any():\n",
    "                if d.to_pydatetime() in FirstFloorJunior:\n",
    "                    FirstFloorJunior[d.to_pydatetime()].append(junior + '(post-take)')\n",
    "                else:\n",
    "                    FirstFloorJunior[d.to_pydatetime()] = [junior]\n",
    "            elif df[d:d][junior][(df[d:d][junior].astype(str).str.contains('Take'))].any():\n",
    "                if d.to_pydatetime() in FirstFloorJunior:\n",
    "                    FirstFloorJunior[d.to_pydatetime()].append(junior + '(on-call)')\n",
    "                else:\n",
    "                    FirstFloorJunior[d.to_pydatetime()] = [junior]\n",
    "\n",
    "    return FirstFloorJunior\n",
    "\n",
    "\n",
    "def SecondFloorReg(df):\n",
    "    SecondFloorReg = {}\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for registrar in reg:\n",
    "            if df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('2'))].any():\n",
    "                SecondFloorReg[d] = registrar \n",
    "                \n",
    "    return SecondFloorReg\n",
    "\n",
    "def SecondFloorJunior(df):\n",
    "    SecondFloorJunior = {}\n",
    "    juniors = ['Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for junior in juniors:\n",
    "            if df[d:d][junior][(df[d:d][junior].astype(str).str.contains('2'))].any():\n",
    "                if d.to_pydatetime() in SecondFloorJunior:\n",
    "                    SecondFloorJunior[d.to_pydatetime()].append(junior)\n",
    "                else:\n",
    "                    SecondFloorJunior[d.to_pydatetime()] = [junior]\n",
    "\n",
    "    return SecondFloorJunior\n",
    "\n",
    "def ClinicReg(df):\n",
    "    ClinicReg = {}\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for registrar in reg:\n",
    "            if df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('Clinic'))].any():\n",
    "                ClinicReg[d] = registrar \n",
    "                \n",
    "    return ClinicReg\n",
    "\n",
    "\n",
    "def Night(df):\n",
    "    Night = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('Night'))].any():\n",
    "                if d.to_pydatetime() in Night:\n",
    "                    Night[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    Night[d.to_pydatetime()] = [s]\n",
    "    return Night\n",
    "\n",
    "def ZeroDay(df):\n",
    "    ZeroDay = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('Zero'))].any():\n",
    "                if d.to_pydatetime() in ZeroDay:\n",
    "                    ZeroDay[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    ZeroDay[d.to_pydatetime()] = [s]\n",
    "    return ZeroDay\n",
    "\n",
    "def AnnualLeave(df):\n",
    "    AnnualLeave = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('AL'))].any():\n",
    "                if d.to_pydatetime() in AnnualLeave:\n",
    "                    AnnualLeave[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    AnnualLeave[d.to_pydatetime()] = [s]\n",
    "\n",
    "    return AnnualLeave\n",
    "\n",
    "def StudyLeave(df):\n",
    "    StudyLeave = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Jennifer', 'Louis', 'Chinonso', 'Sommer', \n",
    "                'Miriam', 'Ved', 'Ernest', 'Anne']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('TRAINING DAY'))].any():\n",
    "                if d.to_pydatetime() in StudyLeave:\n",
    "                    StudyLeave[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    StudyLeave[d.to_pydatetime()] = [s]\n",
    "            elif df[d:d][s][(df[d:d][s].astype(str).str.contains('SL'))].any():\n",
    "                if d.to_pydatetime() in StudyLeave:\n",
    "                    StudyLeave[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    StudyLeave[d.to_pydatetime()] = [s]\n",
    "                    \n",
    "    return StudyLeave\n",
    "\n",
    "def MorningClinic(df):\n",
    "    MorningClinic = {}\n",
    "    for d in df['Date']:\n",
    "        if d.weekday() == 0:\n",
    "            MorningClinic[d] = 'ILD : no reg'\n",
    "        elif d.weekday() == 1:\n",
    "             MorningClinic[d] = 'TB : no reg'\n",
    "        elif d.weekday() == 2:\n",
    "             MorningClinic[d] = 'COPD/GEN : no reg'\n",
    "        elif d.weekday() == 3:\n",
    "             MorningClinic[d] = 'MDT : no reg'\n",
    "        elif d.weekday() == 4:\n",
    "             MorningClinic[d] = ''\n",
    "    \n",
    "    return MorningClinic\n",
    "    \n",
    "def AfternoonClinic(df):\n",
    "    AfternoonClinic = {}\n",
    "    for d in df['Date']:\n",
    "        if d.weekday() == 0:\n",
    "            AfternoonClinic[d] = ''\n",
    "        elif d.weekday() == 1:\n",
    "             AfternoonClinic[d] = ''\n",
    "        elif d.weekday() == 2:\n",
    "             AfternoonClinic[d] = 'General : no reg'\n",
    "        elif d.weekday() == 3:\n",
    "             AfternoonClinic[d] = 'Fast track : no reg'\n",
    "        elif d.weekday() == 4:\n",
    "             AfternoonClinic[d] = ''\n",
    "    \n",
    "    return AfternoonClinic\n",
    "\n",
    "def Bronch(df):\n",
    "    Bronch = {}\n",
    "    for d in df['Date']:\n",
    "        if d.weekday() == 0:\n",
    "            Bronch[d] = 'Han/Bloch : no reg'\n",
    "        elif d.weekday() == 1:\n",
    "             Bronch[d] = 'Elkin/Counihan : no reg'\n",
    "        elif d.weekday() == 2:\n",
    "             Bronch[d] = 'Berry/Ross : no reg'\n",
    "        elif d.weekday() == 3:\n",
    "             Bronch[d] = 'Wick : no reg'\n",
    "        elif d.weekday() == 4:\n",
    "             Bronch[d] = 'Kon : no reg'\n",
    "    \n",
    "    return Bronch\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "df = load_master_rota()\n",
    "df = next_week(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Date</th>\n",
       "      <th>2016-08-01 00:00:00</th>\n",
       "      <th>2016-08-02 00:00:00</th>\n",
       "      <th>NaT</th>\n",
       "      <th>2016-08-03 00:00:00</th>\n",
       "      <th>2016-08-04 00:00:00</th>\n",
       "      <th>2016-08-05 00:00:00</th>\n",
       "      <th>2016-08-06 00:00:00</th>\n",
       "      <th>2016-08-07 00:00:00</th>\n",
       "      <th>2016-08-08 00:00:00</th>\n",
       "      <th>2016-08-09 00:00:00</th>\n",
       "      <th>2016-08-10 00:00:00</th>\n",
       "      <th>2016-08-11 00:00:00</th>\n",
       "      <th>2016-08-12 00:00:00</th>\n",
       "      <th>2016-08-13 00:00:00</th>\n",
       "      <th>2016-08-14 00:00:00</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <td>2016-08-01 00:00:00</td>\n",
       "      <td>2016-08-02 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016-08-03 00:00:00</td>\n",
       "      <td>2016-08-04 00:00:00</td>\n",
       "      <td>2016-08-05 00:00:00</td>\n",
       "      <td>2016-08-06 00:00:00</td>\n",
       "      <td>2016-08-07 00:00:00</td>\n",
       "      <td>2016-08-08 00:00:00</td>\n",
       "      <td>2016-08-09 00:00:00</td>\n",
       "      <td>2016-08-10 00:00:00</td>\n",
       "      <td>2016-08-11 00:00:00</td>\n",
       "      <td>2016-08-12 00:00:00</td>\n",
       "      <td>2016-08-13 00:00:00</td>\n",
       "      <td>2016-08-14 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Day</th>\n",
       "      <td>Monday</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Sunday</td>\n",
       "      <td>Monday</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Sunday</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Consultant</th>\n",
       "      <td>PM</td>\n",
       "      <td>PM</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Manvers Consultant</th>\n",
       "      <td>WARDS: TB (CR)GKR</td>\n",
       "      <td>WARDS: TB (CR)GKR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MB</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SE</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LYH</th>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>OMK</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WO</th>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MW</th>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PM</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IC</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SB</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CR</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GR</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LM</th>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Chris</th>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Carl</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Simon</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>SL</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Reza</th>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Jennifer</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Jennifer \\nMarin</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Louis</th>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>Louis \\nPeters</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>PT</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Chinonso</th>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Chinonso \\nNwoguh</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sommer</th>\n",
       "      <td>PT</td>\n",
       "      <td>AL</td>\n",
       "      <td>Sommer \\nLang</td>\n",
       "      <td>1</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>PT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Miriam</th>\n",
       "      <td>1</td>\n",
       "      <td>Take</td>\n",
       "      <td>Miriam\\nSamuel</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>2nd on</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ved</th>\n",
       "      <td>Zero</td>\n",
       "      <td>1</td>\n",
       "      <td>Veidika\\nChohan</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ernest</th>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>Ernest \\nChew</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>Zero</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Anne</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Anne\\nTear</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Date                             2016-08-01           2016-08-02  \\\n",
       "Date                    2016-08-01 00:00:00  2016-08-02 00:00:00   \n",
       "Day                                  Monday              Tuesday   \n",
       "First Floor Consultant                   PM                   PM   \n",
       "Manvers Consultant        WARDS: TB (CR)GKR    WARDS: TB (CR)GKR   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                      NaN                  NaN   \n",
       "LYH                                      AL                   AL   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                       AL                   AL   \n",
       "MW                                       AL                   AL   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                   AL   \n",
       "Chris                                    AL                   AL   \n",
       "Carl                                      2                    2   \n",
       "Simon                                     1                    1   \n",
       "Reza                                     AL                   AL   \n",
       "Jennifer                                      2                    2   \n",
       "Louis                                    AL                   AL   \n",
       "Chinonso                                  Zero                 Zero   \n",
       "Sommer                                     PT                   AL   \n",
       "Miriam                                  1                 Take   \n",
       "Ved                                   Zero                    1   \n",
       "Ernest                                 Take                   PT   \n",
       "Anne                                      2                    2   \n",
       "\n",
       "Date                                  NaT           2016-08-03  \\\n",
       "Date                                  NaN  2016-08-03 00:00:00   \n",
       "Day                                   NaN            Wednesday   \n",
       "First Floor Consultant                NaN                   SB   \n",
       "Manvers Consultant                    NaN            WARDS: MB   \n",
       "MB                                    NaN                  NaN   \n",
       "SE                                    NaN                  NaN   \n",
       "LYH                                   NaN                   AL   \n",
       "OMK                                   NaN                  NaN   \n",
       "WO                                    NaN                   AL   \n",
       "MW                                    NaN                   AL   \n",
       "PM                                    NaN                  NaN   \n",
       "IC                                    NaN                  NaN   \n",
       "SB                                    NaN                  NaN   \n",
       "CR                                    NaN                  NaN   \n",
       "GR                                    NaN                  NaN   \n",
       "LM                                    NaN                   AL   \n",
       "Chris                                 NaN                   AL   \n",
       "Carl                                  NaN                    2   \n",
       "Simon                                 NaN                 Take   \n",
       "Reza                                  NaN               CLINIC   \n",
       "Jennifer                     Jennifer \\nMarin                    2   \n",
       "Louis                      Louis \\nPeters               2nd on   \n",
       "Chinonso                   Chinonso \\nNwoguh                 Take   \n",
       "Sommer                        Sommer \\nLang                    1   \n",
       "Miriam                   Miriam\\nSamuel                 Zero   \n",
       "Ved                      Veidika\\nChohan                    2   \n",
       "Ernest                      Ernest \\nChew                    2   \n",
       "Anne                           Anne\\nTear                 Take   \n",
       "\n",
       "Date                             2016-08-04           2016-08-05  \\\n",
       "Date                    2016-08-04 00:00:00  2016-08-05 00:00:00   \n",
       "Day                                Thursday               Friday   \n",
       "First Floor Consultant                   SB                   SB   \n",
       "Manvers Consultant                WARDS: MB            WARDS: MB   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                      NaN                  NaN   \n",
       "LYH                                      AL                   AL   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                       AL                   AL   \n",
       "MW                                       AL                   AL   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                   AL   \n",
       "Chris                                    AL                Night   \n",
       "Carl                                      2                    2   \n",
       "Simon                                    PT                   AL   \n",
       "Reza                                 CLINIC                    1   \n",
       "Jennifer                                      2                    2   \n",
       "Louis                                    PT                 Zero   \n",
       "Chinonso                                    PT                Night   \n",
       "Sommer                                 2nd on                   PT   \n",
       "Miriam                               Zero                 Zero   \n",
       "Ved                                      2                    2   \n",
       "Ernest                                    2                    2   \n",
       "Anne                                     PT                    1   \n",
       "\n",
       "Date                             2016-08-06           2016-08-07  \\\n",
       "Date                    2016-08-06 00:00:00  2016-08-07 00:00:00   \n",
       "Day                                Saturday               Sunday   \n",
       "First Floor Consultant                  NaN                  NaN   \n",
       "Manvers Consultant                      NaN                  NaN   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                      NaN                  NaN   \n",
       "LYH                                     NaN                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                      NaN                  NaN   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                 Night                Night   \n",
       "Carl                                    NaN                  NaN   \n",
       "Simon                                   NaN                  NaN   \n",
       "Reza                                    NaN                  NaN   \n",
       "Jennifer                                    NaN                  NaN   \n",
       "Louis                                   NaN                  NaN   \n",
       "Chinonso                                 Night                Night   \n",
       "Sommer                                    NaN                  NaN   \n",
       "Miriam                                NaN                  NaN   \n",
       "Ved                                    NaN                  NaN   \n",
       "Ernest                               2nd on               2nd on   \n",
       "Anne                                    NaN                  NaN   \n",
       "\n",
       "Date                             2016-08-08           2016-08-09  \\\n",
       "Date                    2016-08-08 00:00:00  2016-08-09 00:00:00   \n",
       "Day                                  Monday              Tuesday   \n",
       "First Floor Consultant                   SB                   SB   \n",
       "Manvers Consultant                WARDS: MB            WARDS: MB   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                      NaN                  NaN   \n",
       "LYH                                      AL                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                       AL                   AL   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                   AL   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                  Zero                 Zero   \n",
       "Carl                                      1                 Take   \n",
       "Simon                                    AL                   SL   \n",
       "Reza                                      2                   AL   \n",
       "Jennifer                                      2                    2   \n",
       "Louis                                     1                 Take   \n",
       "Chinonso                                  Zero                 Zero   \n",
       "Sommer                                  Night                Night   \n",
       "Miriam                                  2                    2   \n",
       "Ved                                      1                 Take   \n",
       "Ernest                                 Zero                    2   \n",
       "Anne                                      2                    2   \n",
       "\n",
       "Date                             2016-08-10           2016-08-11  \\\n",
       "Date                    2016-08-10 00:00:00  2016-08-11 00:00:00   \n",
       "Day                               Wednesday             Thursday   \n",
       "First Floor Consultant                   SB                   SB   \n",
       "Manvers Consultant                WARDS: MB            WARDS: MB   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                      NaN                  NaN   \n",
       "LYH                                     NaN                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                       AL                   AL   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                  Zero                 Zero   \n",
       "Carl                                     PT                    1   \n",
       "Simon                                     2                    2   \n",
       "Reza                                     AL                   AL   \n",
       "Jennifer                                      2                    2   \n",
       "Louis                                    PT                    1   \n",
       "Chinonso                                  Zero                 Zero   \n",
       "Sommer                                  Night                Night   \n",
       "Miriam                                  2                    2   \n",
       "Ved                                     PT                    1   \n",
       "Ernest                                    2                    2   \n",
       "Anne                                      2                    2   \n",
       "\n",
       "Date                             2016-08-12           2016-08-13  \\\n",
       "Date                    2016-08-12 00:00:00  2016-08-13 00:00:00   \n",
       "Day                                  Friday             Saturday   \n",
       "First Floor Consultant                   SB                  NaN   \n",
       "Manvers Consultant                WARDS: MB                  NaN   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                      NaN                  NaN   \n",
       "LYH                                     NaN                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                       AL                  NaN   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                  Zero                  NaN   \n",
       "Carl                                      1                  NaN   \n",
       "Simon                                     2                  NaN   \n",
       "Reza                                     AL                  NaN   \n",
       "Jennifer                                      2                 Take   \n",
       "Louis                                     1                  NaN   \n",
       "Chinonso                                  Zero                  NaN   \n",
       "Sommer                                   Zero                  NaN   \n",
       "Miriam                                  2               2nd on   \n",
       "Ved                                      1                  NaN   \n",
       "Ernest                                    2                  NaN   \n",
       "Anne                                      2                  NaN   \n",
       "\n",
       "Date                             2016-08-14  \n",
       "Date                    2016-08-14 00:00:00  \n",
       "Day                                  Sunday  \n",
       "First Floor Consultant                  NaN  \n",
       "Manvers Consultant                      NaN  \n",
       "MB                                      NaN  \n",
       "SE                                      NaN  \n",
       "LYH                                     NaN  \n",
       "OMK                                     NaN  \n",
       "WO                                      NaN  \n",
       "MW                                      NaN  \n",
       "PM                                      NaN  \n",
       "IC                                      NaN  \n",
       "SB                                      NaN  \n",
       "CR                                      NaN  \n",
       "GR                                      NaN  \n",
       "LM                                      NaN  \n",
       "Chris                                   NaN  \n",
       "Carl                                    NaN  \n",
       "Simon                                   NaN  \n",
       "Reza                                    NaN  \n",
       "Jennifer                                     PT  \n",
       "Louis                                   NaN  \n",
       "Chinonso                                   NaN  \n",
       "Sommer                                    NaN  \n",
       "Miriam                             2nd on  \n",
       "Ved                                    NaN  \n",
       "Ernest                                  NaN  \n",
       "Anne                                    NaN  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "first = (('First Floor Registrar (#1028)', FirstFloorReg(df)), \n",
    "         ('First Floor Juniors (#1656, 1016)', FirstFloorJunior(df)))\n",
    "\n",
    "second = (('Second Floor Registrar (#1238)', SecondFloorReg(df)),\n",
    "         ('Second Floor Juniors (#1208, 1138)', SecondFloorJunior(df)))\n",
    "\n",
    "other = (('Morning Clinic : Reg', MorningClinic(df)),\n",
    "        ('Afternoon Clinic : Reg', AfternoonClinic(df)),\n",
    "        ('Bronchoscopy : Reg', Bronch(df)),\n",
    "        ('Clinic Registrar', ClinicReg(df)),\n",
    "        ('Nights', Night(df)),\n",
    "        ('Zero Days', ZeroDay(df)),\n",
    "        ('Annual Leave', AnnualLeave(df)),\n",
    "        ('Study Leave', StudyLeave(df)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "first = collections.OrderedDict(first)\n",
    "second = collections.OrderedDict(second)\n",
    "other = collections.OrderedDict(other)\n",
    "\n",
    "a = df.ix[:,1:3].transpose()\n",
    "b = pd.DataFrame(first).transpose()\n",
    "c = df.ix[:,3:4].transpose()\n",
    "d = pd.DataFrame(second).transpose()\n",
    "e = pd.DataFrame(other).transpose()\n",
    "\n",
    "data_frames = [a,b,c,d,e]\n",
    "\n",
    "weeklyrota = pd.concat(data_frames).fillna('')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>NaT</th>\n",
       "      <th>2016-08-01 00:00:00</th>\n",
       "      <th>2016-08-02 00:00:00</th>\n",
       "      <th>2016-08-03 00:00:00</th>\n",
       "      <th>2016-08-04 00:00:00</th>\n",
       "      <th>2016-08-05 00:00:00</th>\n",
       "      <th>2016-08-06 00:00:00</th>\n",
       "      <th>2016-08-07 00:00:00</th>\n",
       "      <th>2016-08-08 00:00:00</th>\n",
       "      <th>2016-08-09 00:00:00</th>\n",
       "      <th>2016-08-10 00:00:00</th>\n",
       "      <th>2016-08-11 00:00:00</th>\n",
       "      <th>2016-08-12 00:00:00</th>\n",
       "      <th>2016-08-13 00:00:00</th>\n",
       "      <th>2016-08-14 00:00:00</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Day</th>\n",
       "      <td></td>\n",
       "      <td>Monday</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Sunday</td>\n",
       "      <td>Monday</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Sunday</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Consultant</th>\n",
       "      <td></td>\n",
       "      <td>PM</td>\n",
       "      <td>PM</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td>SB</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Registrar (#1028)</th>\n",
       "      <td></td>\n",
       "      <td>Simon</td>\n",
       "      <td>Simon</td>\n",
       "      <td>Simon(on-call)</td>\n",
       "      <td>Simon(post-take)</td>\n",
       "      <td>Reza</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Carl</td>\n",
       "      <td>Carl(on-call)</td>\n",
       "      <td>Carl(post-take)</td>\n",
       "      <td>Carl</td>\n",
       "      <td>Carl</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Juniors (#1656, 1016)</th>\n",
       "      <td></td>\n",
       "      <td>[Sommer, Miriam, Ernest(on-call)]</td>\n",
       "      <td>[Miriam, Ved, Ernest(post-take)]</td>\n",
       "      <td>[Chinonso, Sommer, Anne(on-call)]</td>\n",
       "      <td>[Louis, Chinonso(post-take), Anne(post-take)]</td>\n",
       "      <td>[Sommer, Anne]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[Louis, Ved]</td>\n",
       "      <td>[Louis, Ved(on-call)]</td>\n",
       "      <td>[Louis, Ved(post-take)]</td>\n",
       "      <td>[Louis, Ved]</td>\n",
       "      <td>[Louis, Ved]</td>\n",
       "      <td>[Jennifer]</td>\n",
       "      <td>[Jennifer]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Manvers Consultant</th>\n",
       "      <td></td>\n",
       "      <td>WARDS: TB (CR)GKR</td>\n",
       "      <td>WARDS: TB (CR)GKR</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Second Floor Registrar (#1238)</th>\n",
       "      <td></td>\n",
       "      <td>Carl</td>\n",
       "      <td>Carl</td>\n",
       "      <td>Carl</td>\n",
       "      <td>Carl</td>\n",
       "      <td>Carl</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Reza</td>\n",
       "      <td></td>\n",
       "      <td>Simon</td>\n",
       "      <td>Simon</td>\n",
       "      <td>Simon</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Second Floor Juniors (#1208, 1138)</th>\n",
       "      <td></td>\n",
       "      <td>[Jennifer, Anne]</td>\n",
       "      <td>[Jennifer, Anne]</td>\n",
       "      <td>[Jennifer, Louis, Ved, Ernest]</td>\n",
       "      <td>[Jennifer, Sommer, Ved, Ernest]</td>\n",
       "      <td>[Jennifer, Ved, Ernest]</td>\n",
       "      <td>[Ernest]</td>\n",
       "      <td>[Ernest]</td>\n",
       "      <td>[Jennifer, Miriam, Anne]</td>\n",
       "      <td>[Jennifer, Miriam, Ernest, Anne]</td>\n",
       "      <td>[Jennifer, Miriam, Ernest, Anne]</td>\n",
       "      <td>[Jennifer, Miriam, Ernest, Anne]</td>\n",
       "      <td>[Jennifer, Miriam, Ernest, Anne]</td>\n",
       "      <td>[Miriam]</td>\n",
       "      <td>[Miriam]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Morning Clinic : Reg</th>\n",
       "      <td></td>\n",
       "      <td>ILD : no reg</td>\n",
       "      <td>TB : no reg</td>\n",
       "      <td>COPD/GEN : no reg</td>\n",
       "      <td>MDT : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>ILD : no reg</td>\n",
       "      <td>TB : no reg</td>\n",
       "      <td>COPD/GEN : no reg</td>\n",
       "      <td>MDT : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Afternoon Clinic : Reg</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>General : no reg</td>\n",
       "      <td>Fast track : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>General : no reg</td>\n",
       "      <td>Fast track : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bronchoscopy : Reg</th>\n",
       "      <td></td>\n",
       "      <td>Han/Bloch : no reg</td>\n",
       "      <td>Elkin/Counihan : no reg</td>\n",
       "      <td>Berry/Ross : no reg</td>\n",
       "      <td>Wick : no reg</td>\n",
       "      <td>Kon : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Han/Bloch : no reg</td>\n",
       "      <td>Elkin/Counihan : no reg</td>\n",
       "      <td>Berry/Ross : no reg</td>\n",
       "      <td>Wick : no reg</td>\n",
       "      <td>Kon : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Clinic Registrar</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Nights</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[Chris, Chinonso]</td>\n",
       "      <td>[Chris, Chinonso]</td>\n",
       "      <td>[Chris, Chinonso]</td>\n",
       "      <td>[Sommer]</td>\n",
       "      <td>[Sommer]</td>\n",
       "      <td>[Sommer]</td>\n",
       "      <td>[Sommer]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zero Days</th>\n",
       "      <td></td>\n",
       "      <td>[Chinonso, Ved]</td>\n",
       "      <td>[Chinonso]</td>\n",
       "      <td>[Miriam]</td>\n",
       "      <td>[Miriam]</td>\n",
       "      <td>[Louis, Miriam]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[Chris, Chinonso, Ernest]</td>\n",
       "      <td>[Chris, Chinonso]</td>\n",
       "      <td>[Chris, Chinonso]</td>\n",
       "      <td>[Chris, Chinonso]</td>\n",
       "      <td>[Chris, Chinonso, Sommer]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Annual Leave</th>\n",
       "      <td></td>\n",
       "      <td>[LYH, WO, MW, Chris, Reza, Louis]</td>\n",
       "      <td>[LYH, WO, MW, Chris, Reza, Louis, Sommer]</td>\n",
       "      <td>[LYH, WO, MW, Chris]</td>\n",
       "      <td>[LYH, WO, MW, Chris]</td>\n",
       "      <td>[LYH, WO, MW, Simon]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[LYH, MW, Simon]</td>\n",
       "      <td>[MW, Reza]</td>\n",
       "      <td>[MW, Reza]</td>\n",
       "      <td>[MW, Reza]</td>\n",
       "      <td>[MW, Reza]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Study Leave</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>[Simon]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   NaT                         2016-08-01  \\\n",
       "Day                                                                Monday   \n",
       "First Floor Consultant                                                 PM   \n",
       "First Floor Registrar (#1028)                                       Simon   \n",
       "First Floor Juniors (#1656, 1016)       [Sommer, Miriam, Ernest(on-call)]   \n",
       "Manvers Consultant                                      WARDS: TB (CR)GKR   \n",
       "Second Floor Registrar (#1238)                                       Carl   \n",
       "Second Floor Juniors (#1208, 1138)                           [Jennifer, Anne]   \n",
       "Morning Clinic : Reg                                         ILD : no reg   \n",
       "Afternoon Clinic : Reg                                                      \n",
       "Bronchoscopy : Reg                                     Han/Bloch : no reg   \n",
       "Clinic Registrar                                                            \n",
       "Nights                                                                      \n",
       "Zero Days                                                   [Chinonso, Ved]   \n",
       "Annual Leave                            [LYH, WO, MW, Chris, Reza, Louis]   \n",
       "Study Leave                                                                 \n",
       "\n",
       "                                                                 2016-08-02  \\\n",
       "Day                                                                 Tuesday   \n",
       "First Floor Consultant                                                   PM   \n",
       "First Floor Registrar (#1028)                                         Simon   \n",
       "First Floor Juniors (#1656, 1016)       [Miriam, Ved, Ernest(post-take)]   \n",
       "Manvers Consultant                                        WARDS: TB (CR)GKR   \n",
       "Second Floor Registrar (#1238)                                         Carl   \n",
       "Second Floor Juniors (#1208, 1138)                             [Jennifer, Anne]   \n",
       "Morning Clinic : Reg                                            TB : no reg   \n",
       "Afternoon Clinic : Reg                                                        \n",
       "Bronchoscopy : Reg                                  Elkin/Counihan : no reg   \n",
       "Clinic Registrar                                                              \n",
       "Nights                                                                        \n",
       "Zero Days                                                           [Chinonso]   \n",
       "Annual Leave                        [LYH, WO, MW, Chris, Reza, Louis, Sommer]   \n",
       "Study Leave                                                                   \n",
       "\n",
       "                                                      2016-08-03  \\\n",
       "Day                                                    Wednesday   \n",
       "First Floor Consultant                                        SB   \n",
       "First Floor Registrar (#1028)                     Simon(on-call)   \n",
       "First Floor Juniors (#1656, 1016)   [Chinonso, Sommer, Anne(on-call)]   \n",
       "Manvers Consultant                                     WARDS: MB   \n",
       "Second Floor Registrar (#1238)                              Carl   \n",
       "Second Floor Juniors (#1208, 1138)   [Jennifer, Louis, Ved, Ernest]   \n",
       "Morning Clinic : Reg                           COPD/GEN : no reg   \n",
       "Afternoon Clinic : Reg                          General : no reg   \n",
       "Bronchoscopy : Reg                           Berry/Ross : no reg   \n",
       "Clinic Registrar                                                   \n",
       "Nights                                                             \n",
       "Zero Days                                             [Miriam]   \n",
       "Annual Leave                                [LYH, WO, MW, Chris]   \n",
       "Study Leave                                                        \n",
       "\n",
       "                                                                    2016-08-04  \\\n",
       "Day                                                                   Thursday   \n",
       "First Floor Consultant                                                      SB   \n",
       "First Floor Registrar (#1028)                                 Simon(post-take)   \n",
       "First Floor Juniors (#1656, 1016)   [Louis, Chinonso(post-take), Anne(post-take)]   \n",
       "Manvers Consultant                                                   WARDS: MB   \n",
       "Second Floor Registrar (#1238)                                            Carl   \n",
       "Second Floor Juniors (#1208, 1138)                  [Jennifer, Sommer, Ved, Ernest]   \n",
       "Morning Clinic : Reg                                              MDT : no reg   \n",
       "Afternoon Clinic : Reg                                     Fast track : no reg   \n",
       "Bronchoscopy : Reg                                               Wick : no reg   \n",
       "Clinic Registrar                                                                 \n",
       "Nights                                                                           \n",
       "Zero Days                                                           [Miriam]   \n",
       "Annual Leave                                              [LYH, WO, MW, Chris]   \n",
       "Study Leave                                                                      \n",
       "\n",
       "                                              2016-08-05      2016-08-06  \\\n",
       "Day                                               Friday        Saturday   \n",
       "First Floor Consultant                                SB                   \n",
       "First Floor Registrar (#1028)                       Reza                   \n",
       "First Floor Juniors (#1656, 1016)           [Sommer, Anne]                   \n",
       "Manvers Consultant                             WARDS: MB                   \n",
       "Second Floor Registrar (#1238)                      Carl                   \n",
       "Second Floor Juniors (#1208, 1138)  [Jennifer, Ved, Ernest]        [Ernest]   \n",
       "Morning Clinic : Reg                                                       \n",
       "Afternoon Clinic : Reg                                                     \n",
       "Bronchoscopy : Reg                          Kon : no reg                   \n",
       "Clinic Registrar                                                           \n",
       "Nights                                    [Chris, Chinonso]  [Chris, Chinonso]   \n",
       "Zero Days                              [Louis, Miriam]                   \n",
       "Annual Leave                        [LYH, WO, MW, Simon]                   \n",
       "Study Leave                                                                \n",
       "\n",
       "                                        2016-08-07              2016-08-08  \\\n",
       "Day                                         Sunday                  Monday   \n",
       "First Floor Consultant                                                  SB   \n",
       "First Floor Registrar (#1028)                                         Carl   \n",
       "First Floor Juniors (#1656, 1016)                            [Louis, Ved]   \n",
       "Manvers Consultant                                               WARDS: MB   \n",
       "Second Floor Registrar (#1238)                                        Reza   \n",
       "Second Floor Juniors (#1208, 1138)        [Ernest]  [Jennifer, Miriam, Anne]   \n",
       "Morning Clinic : Reg                                          ILD : no reg   \n",
       "Afternoon Clinic : Reg                                                       \n",
       "Bronchoscopy : Reg                                      Han/Bloch : no reg   \n",
       "Clinic Registrar                                                             \n",
       "Nights                              [Chris, Chinonso]                  [Sommer]   \n",
       "Zero Days                                           [Chris, Chinonso, Ernest]   \n",
       "Annual Leave                                              [LYH, MW, Simon]   \n",
       "Study Leave                                                                  \n",
       "\n",
       "                                                        2016-08-09  \\\n",
       "Day                                                        Tuesday   \n",
       "First Floor Consultant                                          SB   \n",
       "First Floor Registrar (#1028)                        Carl(on-call)   \n",
       "First Floor Juniors (#1656, 1016)           [Louis, Ved(on-call)]   \n",
       "Manvers Consultant                                       WARDS: MB   \n",
       "Second Floor Registrar (#1238)                                       \n",
       "Second Floor Juniors (#1208, 1138)  [Jennifer, Miriam, Ernest, Anne]   \n",
       "Morning Clinic : Reg                                   TB : no reg   \n",
       "Afternoon Clinic : Reg                                               \n",
       "Bronchoscopy : Reg                         Elkin/Counihan : no reg   \n",
       "Clinic Registrar                                                     \n",
       "Nights                                                      [Sommer]   \n",
       "Zero Days                                           [Chris, Chinonso]   \n",
       "Annual Leave                                            [MW, Reza]   \n",
       "Study Leave                                                [Simon]   \n",
       "\n",
       "                                                        2016-08-10  \\\n",
       "Day                                                      Wednesday   \n",
       "First Floor Consultant                                          SB   \n",
       "First Floor Registrar (#1028)                      Carl(post-take)   \n",
       "First Floor Juniors (#1656, 1016)         [Louis, Ved(post-take)]   \n",
       "Manvers Consultant                                       WARDS: MB   \n",
       "Second Floor Registrar (#1238)                               Simon   \n",
       "Second Floor Juniors (#1208, 1138)  [Jennifer, Miriam, Ernest, Anne]   \n",
       "Morning Clinic : Reg                             COPD/GEN : no reg   \n",
       "Afternoon Clinic : Reg                            General : no reg   \n",
       "Bronchoscopy : Reg                             Berry/Ross : no reg   \n",
       "Clinic Registrar                                                     \n",
       "Nights                                                      [Sommer]   \n",
       "Zero Days                                           [Chris, Chinonso]   \n",
       "Annual Leave                                            [MW, Reza]   \n",
       "Study Leave                                                          \n",
       "\n",
       "                                                        2016-08-11  \\\n",
       "Day                                                       Thursday   \n",
       "First Floor Consultant                                          SB   \n",
       "First Floor Registrar (#1028)                                 Carl   \n",
       "First Floor Juniors (#1656, 1016)                    [Louis, Ved]   \n",
       "Manvers Consultant                                       WARDS: MB   \n",
       "Second Floor Registrar (#1238)                               Simon   \n",
       "Second Floor Juniors (#1208, 1138)  [Jennifer, Miriam, Ernest, Anne]   \n",
       "Morning Clinic : Reg                                  MDT : no reg   \n",
       "Afternoon Clinic : Reg                         Fast track : no reg   \n",
       "Bronchoscopy : Reg                                   Wick : no reg   \n",
       "Clinic Registrar                                                     \n",
       "Nights                                                      [Sommer]   \n",
       "Zero Days                                           [Chris, Chinonso]   \n",
       "Annual Leave                                            [MW, Reza]   \n",
       "Study Leave                                                          \n",
       "\n",
       "                                                        2016-08-12  \\\n",
       "Day                                                         Friday   \n",
       "First Floor Consultant                                          SB   \n",
       "First Floor Registrar (#1028)                                 Carl   \n",
       "First Floor Juniors (#1656, 1016)                    [Louis, Ved]   \n",
       "Manvers Consultant                                       WARDS: MB   \n",
       "Second Floor Registrar (#1238)                               Simon   \n",
       "Second Floor Juniors (#1208, 1138)  [Jennifer, Miriam, Ernest, Anne]   \n",
       "Morning Clinic : Reg                                                 \n",
       "Afternoon Clinic : Reg                                               \n",
       "Bronchoscopy : Reg                                    Kon : no reg   \n",
       "Clinic Registrar                                                     \n",
       "Nights                                                               \n",
       "Zero Days                                     [Chris, Chinonso, Sommer]   \n",
       "Annual Leave                                            [MW, Reza]   \n",
       "Study Leave                                                          \n",
       "\n",
       "                                    2016-08-13  2016-08-14  \n",
       "Day                                   Saturday      Sunday  \n",
       "First Floor Consultant                                      \n",
       "First Floor Registrar (#1028)                               \n",
       "First Floor Juniors (#1656, 1016)       [Jennifer]      [Jennifer]  \n",
       "Manvers Consultant                                          \n",
       "Second Floor Registrar (#1238)                              \n",
       "Second Floor Juniors (#1208, 1138)  [Miriam]  [Miriam]  \n",
       "Morning Clinic : Reg                                        \n",
       "Afternoon Clinic : Reg                                      \n",
       "Bronchoscopy : Reg                                          \n",
       "Clinic Registrar                                            \n",
       "Nights                                                      \n",
       "Zero Days                                                   \n",
       "Annual Leave                                                \n",
       "Study Leave                                                 "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weeklyrota"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "d = datetime.date.today()\n",
    "week_starts = next_weekday(d, 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "rotaname = '%s_weekly_rota.csv' % next_weekday(d, 0)\n",
    "rotaname2 = '%s_weekly_rota.xls' % next_weekday(d, 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "weeklyrota.to_csv(rotaname)\n",
    "weeklyrota.to_excel(rotaname2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Date\n",
       "2016-08-01        AL\n",
       "2016-08-02        AL\n",
       "NaT              NaN\n",
       "2016-08-03    CLINIC\n",
       "2016-08-04    CLINIC\n",
       "2016-08-05         1\n",
       "2016-08-06       NaN\n",
       "2016-08-07       NaN\n",
       "2016-08-08         2\n",
       "2016-08-09        AL\n",
       "2016-08-10        AL\n",
       "2016-08-11        AL\n",
       "2016-08-12        AL\n",
       "2016-08-13       NaN\n",
       "2016-08-14       NaN\n",
       "Name: Reza, dtype: object"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Reza']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Day</th>\n",
       "      <th>First Floor Consultant</th>\n",
       "      <th>Manvers Consultant</th>\n",
       "      <th>MB</th>\n",
       "      <th>SE</th>\n",
       "      <th>LYH</th>\n",
       "      <th>OMK</th>\n",
       "      <th>WO</th>\n",
       "      <th>MW</th>\n",
       "      <th>...</th>\n",
       "      <th>Simon</th>\n",
       "      <th>Reza</th>\n",
       "      <th>Jennifer</th>\n",
       "      <th>Louis</th>\n",
       "      <th>Chinonso</th>\n",
       "      <th>Sommer</th>\n",
       "      <th>Miriam</th>\n",
       "      <th>Ved</th>\n",
       "      <th>Ernest</th>\n",
       "      <th>Anne</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-08-01</th>\n",
       "      <td>2016-08-01</td>\n",
       "      <td>Monday</td>\n",
       "      <td>PM</td>\n",
       "      <td>WARDS: TB (CR)GKR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>AL</td>\n",
       "      <td>2</td>\n",
       "      <td>AL</td>\n",
       "      <td>Zero</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Take</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-08-02</th>\n",
       "      <td>2016-08-02</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>PM</td>\n",
       "      <td>WARDS: TB (CR)GKR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>AL</td>\n",
       "      <td>2</td>\n",
       "      <td>AL</td>\n",
       "      <td>Zero</td>\n",
       "      <td>AL</td>\n",
       "      <td>Take</td>\n",
       "      <td>1</td>\n",
       "      <td>PT</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>NaT</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Jennifer \\nMarin</td>\n",
       "      <td>Louis \\nPeters</td>\n",
       "      <td>Chinonso \\nNwoguh</td>\n",
       "      <td>Sommer \\nLang</td>\n",
       "      <td>Miriam\\nSamuel</td>\n",
       "      <td>Veidika\\nChohan</td>\n",
       "      <td>Ernest \\nChew</td>\n",
       "      <td>Anne\\nTear</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-08-03</th>\n",
       "      <td>2016-08-03</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>SB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>...</td>\n",
       "      <td>Take</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>2</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>Take</td>\n",
       "      <td>1</td>\n",
       "      <td>Zero</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Take</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-08-04</th>\n",
       "      <td>2016-08-04</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>SB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>AL</td>\n",
       "      <td>...</td>\n",
       "      <td>PT</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>2</td>\n",
       "      <td>PT</td>\n",
       "      <td>PT</td>\n",
       "      <td>2nd on</td>\n",
       "      <td>Zero</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>PT</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 Date        Day First Floor Consultant Manvers Consultant  \\\n",
       "Date                                                                         \n",
       "2016-08-01 2016-08-01     Monday                     PM  WARDS: TB (CR)GKR   \n",
       "2016-08-02 2016-08-02    Tuesday                     PM  WARDS: TB (CR)GKR   \n",
       "NaT               NaT        NaN                    NaN                NaN   \n",
       "2016-08-03 2016-08-03  Wednesday                     SB          WARDS: MB   \n",
       "2016-08-04 2016-08-04   Thursday                     SB          WARDS: MB   \n",
       "\n",
       "             MB   SE  LYH  OMK   WO   MW     ...      Simon    Reza  \\\n",
       "Date                                         ...                      \n",
       "2016-08-01  NaN  NaN   AL  NaN   AL   AL     ...          1      AL   \n",
       "2016-08-02  NaN  NaN   AL  NaN   AL   AL     ...          1      AL   \n",
       "NaT         NaN  NaN  NaN  NaN  NaN  NaN     ...        NaN     NaN   \n",
       "2016-08-03  NaN  NaN   AL  NaN   AL   AL     ...       Take  CLINIC   \n",
       "2016-08-04  NaN  NaN   AL  NaN   AL   AL     ...         PT  CLINIC   \n",
       "\n",
       "                        Jennifer           Louis              Chinonso  \\\n",
       "Date                                                              \n",
       "2016-08-01                 2              AL               Zero   \n",
       "2016-08-02                 2              AL               Zero   \n",
       "NaT         Jennifer \\nMarin  Louis \\nPeters  Chinonso \\nNwoguh   \n",
       "2016-08-03                 2          2nd on               Take   \n",
       "2016-08-04                 2              PT                 PT   \n",
       "\n",
       "                     Sommer        Miriam             Ved         Ernest  \\\n",
       "Date                                                                        \n",
       "2016-08-01             PT               1             Zero           Take   \n",
       "2016-08-02             AL            Take                1             PT   \n",
       "NaT         Sommer \\nLang  Miriam\\nSamuel  Veidika\\nChohan  Ernest \\nChew   \n",
       "2016-08-03              1            Zero                2              2   \n",
       "2016-08-04         2nd on            Zero                2              2   \n",
       "\n",
       "                  Anne  \n",
       "Date                    \n",
       "2016-08-01           2  \n",
       "2016-08-02           2  \n",
       "NaT         Anne\\nTear  \n",
       "2016-08-03        Take  \n",
       "2016-08-04          PT  \n",
       "\n",
       "[5 rows x 28 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Date\n",
       "2016-08-01       1\n",
       "2016-08-02       1\n",
       "NaT            NaN\n",
       "2016-08-03    Take\n",
       "2016-08-04      PT\n",
       "2016-08-05      AL\n",
       "2016-08-06     NaN\n",
       "2016-08-07     NaN\n",
       "2016-08-08      AL\n",
       "2016-08-09      SL\n",
       "2016-08-10       2\n",
       "2016-08-11       2\n",
       "2016-08-12       2\n",
       "2016-08-13     NaN\n",
       "2016-08-14     NaN\n",
       "Name: Simon, dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Simon']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
