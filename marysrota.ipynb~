{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##problem\n",
    "1. as a doctor I need to be able easily see where my team is on a weekly basis \n",
    "2. as a doctor with responsibility for the weekly rota I need a way of generating a weekly view from the the master rota that is robust and time efficient\n",
    "n.b the current approach of manually creating a weekly view of the master rota is prone to transcription error and a waste of clinical time\n",
    "\n",
    "##approach\n",
    "1. automate the task of creating a weekly view of the master rota with python\n",
    "2. longer term, maybe a giant excel spreadsheet isn't the optimal master rota solution?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import datetime\n",
    "import collections"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def next_weekday(d, weekday):\n",
    "    days_ahead = weekday - d.weekday()\n",
    "    if days_ahead <= 0: # Target day already happened this week\n",
    "        days_ahead += 7\n",
    "        return d + datetime.timedelta(days_ahead)\n",
    "    \n",
    "def next_week(df):\n",
    "    d = datetime.date.today()\n",
    "    next_monday = next_weekday(d, 0) # 0 = Monday, 1=Tuesday, 2=Wednesday...\n",
    "    following_monday = next_monday + datetime.timedelta(6)\n",
    "    weekly_rota = df[next_monday:following_monday] #next week cut\n",
    "    return weekly_rota\n",
    "\n",
    "def load_master_rota():\n",
    "    master_rota = 'data/wota.xlsx'\n",
    "\n",
    "    cols = range(0,42)\n",
    "    df = pd.read_excel(master_rota, dayfirst=True, skiprows=1340, usecols=cols) #load our spreadsheet\n",
    "    \n",
    "    current_cols = ['Date', 'Day', 'Notes', 'ConsOnCallNote1', 'ConsOnCallNote2', 'First Floor Consultant', 'Manvers Consultant', \n",
    "                'MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', 'GR', 'LM',\n",
    "                'Date1', 'Day1', 'SprNote1', 'SprNote2', 'NoReg1', 'NoReg2', 'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Date2', 'Day2', 'Dana', 'Defne', 'Becky', 'NoSHO1', 'NoSHO2', 'NoSHO3', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing'] #define column headings\n",
    "\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "\n",
    "    assert len(df.columns) == len(current_cols) #sanity check\n",
    "\n",
    "    df.columns = current_cols #set our column names\n",
    "\n",
    "    df = df[['Date', 'Day', 'First Floor Consultant', 'Manvers Consultant', \n",
    "                'MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', 'GR', 'LM',\n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']]  #throw away columns we don't need\n",
    "\n",
    "    df.index = df.Date #lets index on the date because its better that way\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def FirstFloorReg(df):\n",
    "    FirstFloorReg = {}\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for registrar in reg:\n",
    "            if df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('1'))].any():\n",
    "                FirstFloorReg[d] = registrar \n",
    "            elif df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('PT'))].any():\n",
    "                FirstFloorReg[d] = registrar + '(post-take)'\n",
    "            elif df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('Take'))].any():\n",
    "                FirstFloorReg[d] = registrar + '(on-call)'\n",
    "                \n",
    "    return FirstFloorReg\n",
    "\n",
    "def FirstFloorJunior(df):\n",
    "    FirstFloorJunior = {}\n",
    "    juniors = ['Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for junior in juniors:\n",
    "            if df[d:d][junior][(df[d:d][junior].astype(str).str.contains('1'))].any():\n",
    "                if d.to_pydatetime() in FirstFloorJunior:\n",
    "                    FirstFloorJunior[d.to_pydatetime()].append(junior)\n",
    "                else:\n",
    "                    FirstFloorJunior[d.to_pydatetime()] = [junior]\n",
    "            elif df[d:d][junior][(df[d:d][junior].astype(str).str.contains('PT'))].any():\n",
    "                if d.to_pydatetime() in FirstFloorJunior:\n",
    "                    FirstFloorJunior[d.to_pydatetime()].append(junior + '(post-take)')\n",
    "                else:\n",
    "                    FirstFloorJunior[d.to_pydatetime()] = [junior]\n",
    "            elif df[d:d][junior][(df[d:d][junior].astype(str).str.contains('Take'))].any():\n",
    "                if d.to_pydatetime() in FirstFloorJunior:\n",
    "                    FirstFloorJunior[d.to_pydatetime()].append(junior + '(on-call)')\n",
    "                else:\n",
    "                    FirstFloorJunior[d.to_pydatetime()] = [junior]\n",
    "\n",
    "    return FirstFloorJunior\n",
    "\n",
    "\n",
    "def SecondFloorReg(df):\n",
    "    SecondFloorReg = {}\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for registrar in reg:\n",
    "            if df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('2'))].any():\n",
    "                SecondFloorReg[d] = registrar \n",
    "                \n",
    "    return SecondFloorReg\n",
    "\n",
    "def SecondFloorJunior(df):\n",
    "    SecondFloorJunior = {}\n",
    "    juniors = ['Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for junior in juniors:\n",
    "            if df[d:d][junior][(df[d:d][junior].astype(str).str.contains('2'))].any():\n",
    "                if d.to_pydatetime() in SecondFloorJunior:\n",
    "                    SecondFloorJunior[d.to_pydatetime()].append(junior)\n",
    "                else:\n",
    "                    SecondFloorJunior[d.to_pydatetime()] = [junior]\n",
    "\n",
    "    return SecondFloorJunior\n",
    "\n",
    "def ClinicReg(df):\n",
    "    ClinicReg = {}\n",
    "    reg = ['Chris', 'Carl', 'Simon', 'Reza']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for registrar in reg:\n",
    "            if df[d:d][registrar][(df[d:d][registrar].astype(str).str.contains('Clinic'))].any():\n",
    "                ClinicReg[d] = registrar \n",
    "                \n",
    "    return ClinicReg\n",
    "\n",
    "\n",
    "def Night(df):\n",
    "    Night = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('Night'))].any():\n",
    "                if d.to_pydatetime() in Night:\n",
    "                    Night[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    Night[d.to_pydatetime()] = [s]\n",
    "    return Night\n",
    "\n",
    "def ZeroDay(df):\n",
    "    ZeroDay = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('Zero'))].any():\n",
    "                if d.to_pydatetime() in ZeroDay:\n",
    "                    ZeroDay[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    ZeroDay[d.to_pydatetime()] = [s]\n",
    "    return ZeroDay\n",
    "\n",
    "def AnnualLeave(df):\n",
    "    AnnualLeave = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('AL'))].any():\n",
    "                if d.to_pydatetime() in AnnualLeave:\n",
    "                    AnnualLeave[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    AnnualLeave[d.to_pydatetime()] = [s]\n",
    "\n",
    "    return AnnualLeave\n",
    "\n",
    "def StudyLeave(df):\n",
    "    StudyLeave = {}\n",
    "    staff = ['MB', 'SE', 'LYH', 'OMK', 'WO', 'MW', 'PM', 'IC', 'SB', 'CR', \n",
    "                'Chris', 'Carl', 'Simon', 'Reza', \n",
    "                'Dana', 'Defne', 'Becky', 'Mike', \n",
    "                'Despoina', 'Kate', 'Rosie', 'Bing']\n",
    "    \n",
    "    for d in df['Date']:\n",
    "        for s in staff:\n",
    "            if df[d:d][s][(df[d:d][s].astype(str).str.contains('TRAINING DAY'))].any():\n",
    "                if d.to_pydatetime() in StudyLeave:\n",
    "                    StudyLeave[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    StudyLeave[d.to_pydatetime()] = [s]\n",
    "            elif df[d:d][s][(df[d:d][s].astype(str).str.contains('SL'))].any():\n",
    "                if d.to_pydatetime() in StudyLeave:\n",
    "                    StudyLeave[d.to_pydatetime()].append(s)\n",
    "                else:\n",
    "                    StudyLeave[d.to_pydatetime()] = [s]\n",
    "                    \n",
    "    return StudyLeave\n",
    "\n",
    "def MorningClinic(df):\n",
    "    MorningClinic = {}\n",
    "    for d in df['Date']:\n",
    "        if d.weekday() == 0:\n",
    "            MorningClinic[d] = 'ILD : no reg'\n",
    "        elif d.weekday() == 1:\n",
    "             MorningClinic[d] = 'TB : no reg'\n",
    "        elif d.weekday() == 2:\n",
    "             MorningClinic[d] = 'COPD/GEN : no reg'\n",
    "        elif d.weekday() == 3:\n",
    "             MorningClinic[d] = 'MDT : no reg'\n",
    "        elif d.weekday() == 4:\n",
    "             MorningClinic[d] = ''\n",
    "    \n",
    "    return MorningClinic\n",
    "    \n",
    "def AfternoonClinic(df):\n",
    "    AfternoonClinic = {}\n",
    "    for d in df['Date']:\n",
    "        if d.weekday() == 0:\n",
    "            AfternoonClinic[d] = ''\n",
    "        elif d.weekday() == 1:\n",
    "             AfternoonClinic[d] = ''\n",
    "        elif d.weekday() == 2:\n",
    "             AfternoonClinic[d] = 'General : no reg'\n",
    "        elif d.weekday() == 3:\n",
    "             AfternoonClinic[d] = 'Fast track : no reg'\n",
    "        elif d.weekday() == 4:\n",
    "             AfternoonClinic[d] = ''\n",
    "    \n",
    "    return AfternoonClinic\n",
    "\n",
    "def Bronch(df):\n",
    "    Bronch = {}\n",
    "    for d in df['Date']:\n",
    "        if d.weekday() == 0:\n",
    "            Bronch[d] = 'Han/Bloch : no reg'\n",
    "        elif d.weekday() == 1:\n",
    "             Bronch[d] = 'Elkin/Counihan : no reg'\n",
    "        elif d.weekday() == 2:\n",
    "             Bronch[d] = 'Berry/Ross : no reg'\n",
    "        elif d.weekday() == 3:\n",
    "             Bronch[d] = 'Wick : no reg'\n",
    "        elif d.weekday() == 4:\n",
    "             Bronch[d] = 'Kon : no reg'\n",
    "    \n",
    "    return Bronch\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "df = load_master_rota()\n",
    "df = next_week(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Date</th>\n",
       "      <th>2016-04-18 00:00:00</th>\n",
       "      <th>2016-04-19 00:00:00</th>\n",
       "      <th>2016-04-20 00:00:00</th>\n",
       "      <th>2016-04-21 00:00:00</th>\n",
       "      <th>2016-04-22 00:00:00</th>\n",
       "      <th>2016-04-23 00:00:00</th>\n",
       "      <th>2016-04-24 00:00:00</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <td>2016-04-18 00:00:00</td>\n",
       "      <td>2016-04-19 00:00:00</td>\n",
       "      <td>2016-04-20 00:00:00</td>\n",
       "      <td>2016-04-21 00:00:00</td>\n",
       "      <td>2016-04-22 00:00:00</td>\n",
       "      <td>2016-04-23 00:00:00</td>\n",
       "      <td>2016-04-24 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Day</th>\n",
       "      <td>Monday</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Sunday</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Consultant</th>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Manvers Consultant</th>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MB</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SE</th>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LYH</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>OMK</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>WO</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MW</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PM</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>IC</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SB</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CR</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>GR</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LM</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Chris</th>\n",
       "      <td>2</td>\n",
       "      <td>SL</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Carl</th>\n",
       "      <td>1</td>\n",
       "      <td>SL</td>\n",
       "      <td>Take</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Simon</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Reza</th>\n",
       "      <td>Zero</td>\n",
       "      <td>Zero</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dana</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Defne</th>\n",
       "      <td>SL</td>\n",
       "      <td>SL</td>\n",
       "      <td>SL</td>\n",
       "      <td>1</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Becky</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>PT</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mike</th>\n",
       "      <td>PT</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>PT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Despoina</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>SL</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>AMU</td>\n",
       "      <td>AMU</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Kate</th>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Night</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rosie</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bing</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Date                             2016-04-18           2016-04-19  \\\n",
       "Date                    2016-04-18 00:00:00  2016-04-19 00:00:00   \n",
       "Day                                  Monday              Tuesday   \n",
       "First Floor Consultant                   MW                   MW   \n",
       "Manvers Consultant                WARDS: MB            WARDS: MB   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                     Zero                 Zero   \n",
       "LYH                                     NaN                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                      NaN                  NaN   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                     2                   SL   \n",
       "Carl                                      1                   SL   \n",
       "Simon                                   NaN                  NaN   \n",
       "Reza                                   Zero                 Zero   \n",
       "Dana                                      1                    1   \n",
       "Defne                                    SL                   SL   \n",
       "Becky                                     2                    2   \n",
       "Mike                                     PT                    2   \n",
       "Despoina                                  2                    2   \n",
       "Kate                                  Night                Night   \n",
       "Rosie                                     2                    2   \n",
       "Bing                                      1                    1   \n",
       "\n",
       "Date                             2016-04-20           2016-04-21  \\\n",
       "Date                    2016-04-20 00:00:00  2016-04-21 00:00:00   \n",
       "Day                               Wednesday             Thursday   \n",
       "First Floor Consultant                   MW                   MW   \n",
       "Manvers Consultant                WARDS: MB            WARDS: MB   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                     Zero                 Zero   \n",
       "LYH                                     NaN                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                      NaN                  NaN   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                      NaN                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                     2                    2   \n",
       "Carl                                   Take                   PT   \n",
       "Simon                                CLINIC               CLINIC   \n",
       "Reza                                 CLINIC               CLINIC   \n",
       "Dana                                      1                   PT   \n",
       "Defne                                    SL                    1   \n",
       "Becky                                     2                   PT   \n",
       "Mike                                      2                    2   \n",
       "Despoina                                 SL                    2   \n",
       "Kate                                  Night                Night   \n",
       "Rosie                                     2                    2   \n",
       "Bing                                      1                    1   \n",
       "\n",
       "Date                             2016-04-22           2016-04-23  \\\n",
       "Date                    2016-04-22 00:00:00  2016-04-23 00:00:00   \n",
       "Day                                  Friday             Saturday   \n",
       "First Floor Consultant                   MW                  NaN   \n",
       "Manvers Consultant                WARDS: MB                  NaN   \n",
       "MB                                      NaN                  NaN   \n",
       "SE                                     Zero                  NaN   \n",
       "LYH                                     NaN                  NaN   \n",
       "OMK                                     NaN                  NaN   \n",
       "WO                                      NaN                  NaN   \n",
       "MW                                      NaN                  NaN   \n",
       "PM                                      NaN                  NaN   \n",
       "IC                                      NaN                  NaN   \n",
       "SB                                       SL                  NaN   \n",
       "CR                                      NaN                  NaN   \n",
       "GR                                      NaN                  NaN   \n",
       "LM                                      NaN                  NaN   \n",
       "Chris                                     2                  NaN   \n",
       "Carl                                      1                  NaN   \n",
       "Simon                                   NaN                  NaN   \n",
       "Reza                                  Night                Night   \n",
       "Dana                                      1                  NaN   \n",
       "Defne                                  Zero                  NaN   \n",
       "Becky                                 Night                Night   \n",
       "Mike                                     PT                  NaN   \n",
       "Despoina                                  2                  AMU   \n",
       "Kate                                   Zero                  NaN   \n",
       "Rosie                                     2                  NaN   \n",
       "Bing                                   Zero                  NaN   \n",
       "\n",
       "Date                             2016-04-24  \n",
       "Date                    2016-04-24 00:00:00  \n",
       "Day                                  Sunday  \n",
       "First Floor Consultant                  NaN  \n",
       "Manvers Consultant                      NaN  \n",
       "MB                                      NaN  \n",
       "SE                                      NaN  \n",
       "LYH                                     NaN  \n",
       "OMK                                     NaN  \n",
       "WO                                      NaN  \n",
       "MW                                      NaN  \n",
       "PM                                      NaN  \n",
       "IC                                      NaN  \n",
       "SB                                      NaN  \n",
       "CR                                      NaN  \n",
       "GR                                      NaN  \n",
       "LM                                      NaN  \n",
       "Chris                                   NaN  \n",
       "Carl                                    NaN  \n",
       "Simon                                   NaN  \n",
       "Reza                                  Night  \n",
       "Dana                                    NaN  \n",
       "Defne                                   NaN  \n",
       "Becky                                 Night  \n",
       "Mike                                    NaN  \n",
       "Despoina                                AMU  \n",
       "Kate                                    NaN  \n",
       "Rosie                                   NaN  \n",
       "Bing                                    NaN  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "first = (('First Floor Registrar (#1028)', FirstFloorReg(df)), \n",
    "         ('First Floor Juniors (#1656, 1016)', FirstFloorJunior(df)))\n",
    "\n",
    "second = (('Second Floor Registrar (#1238)', SecondFloorReg(df)),\n",
    "         ('Second Floor Juniors (#1208, 1138)', SecondFloorJunior(df)))\n",
    "\n",
    "other = (('Morning Clinic : Reg', MorningClinic(df)),\n",
    "        ('Afternoon Clinic : Reg', AfternoonClinic(df)),\n",
    "        ('Bronchoscopy : Reg', Bronch(df)),\n",
    "        ('Clinic Registrar', ClinicReg(df)),\n",
    "        ('Nights', Night(df)),\n",
    "        ('Zero Days', ZeroDay(df)),\n",
    "        ('Annual Leave', AnnualLeave(df)),\n",
    "        ('Study Leave', StudyLeave(df)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "first = collections.OrderedDict(first)\n",
    "second = collections.OrderedDict(second)\n",
    "other = collections.OrderedDict(other)\n",
    "\n",
    "a = df.ix[:,1:3].transpose()\n",
    "b = pd.DataFrame(first).transpose()\n",
    "c = df.ix[:,3:4].transpose()\n",
    "d = pd.DataFrame(second).transpose()\n",
    "e = pd.DataFrame(other).transpose()\n",
    "\n",
    "data_frames = [a,b,c,d,e]\n",
    "\n",
    "weeklyrota = pd.concat(data_frames).fillna('')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>2016-04-18 00:00:00</th>\n",
       "      <th>2016-04-19 00:00:00</th>\n",
       "      <th>2016-04-20 00:00:00</th>\n",
       "      <th>2016-04-21 00:00:00</th>\n",
       "      <th>2016-04-22 00:00:00</th>\n",
       "      <th>2016-04-23 00:00:00</th>\n",
       "      <th>2016-04-24 00:00:00</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Day</th>\n",
       "      <td>Monday</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>Friday</td>\n",
       "      <td>Saturday</td>\n",
       "      <td>Sunday</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Consultant</th>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td>MW</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Registrar (#1028)</th>\n",
       "      <td>Carl</td>\n",
       "      <td></td>\n",
       "      <td>Carl(on-call)</td>\n",
       "      <td>Carl(post-take)</td>\n",
       "      <td>Carl</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>First Floor Juniors (#1656, 1016)</th>\n",
       "      <td>[Dana, Mike(post-take), Bing]</td>\n",
       "      <td>[Dana, Bing]</td>\n",
       "      <td>[Dana, Bing]</td>\n",
       "      <td>[Dana, Defne, Becky(post-take), Bing]</td>\n",
       "      <td>[Dana, Mike(post-take)]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Manvers Consultant</th>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Second Floor Registrar (#1238)</th>\n",
       "      <td>Chris</td>\n",
       "      <td></td>\n",
       "      <td>Chris</td>\n",
       "      <td>Chris</td>\n",
       "      <td>Chris</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Second Floor Juniors (#1208, 1138)</th>\n",
       "      <td>[Becky, Despoina, Rosie]</td>\n",
       "      <td>[Becky, Mike, Despoina, Rosie]</td>\n",
       "      <td>[Becky, Mike, Rosie]</td>\n",
       "      <td>[Mike, Despoina, Rosie]</td>\n",
       "      <td>[Despoina, Rosie]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Morning Clinic : Reg</th>\n",
       "      <td>ILD : no reg</td>\n",
       "      <td>TB : no reg</td>\n",
       "      <td>COPD/GEN : no reg</td>\n",
       "      <td>MDT : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Afternoon Clinic : Reg</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>General : no reg</td>\n",
       "      <td>Fast track : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bronchoscopy : Reg</th>\n",
       "      <td>Han/Bloch : no reg</td>\n",
       "      <td>Elkin/Counihan : no reg</td>\n",
       "      <td>Berry/Ross : no reg</td>\n",
       "      <td>Wick : no reg</td>\n",
       "      <td>Kon : no reg</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Clinic Registrar</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Nights</th>\n",
       "      <td>[Kate]</td>\n",
       "      <td>[Kate]</td>\n",
       "      <td>[Kate]</td>\n",
       "      <td>[Kate]</td>\n",
       "      <td>[Reza, Becky]</td>\n",
       "      <td>[Reza, Becky]</td>\n",
       "      <td>[Reza, Becky]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zero Days</th>\n",
       "      <td>[SE, Reza]</td>\n",
       "      <td>[SE, Reza]</td>\n",
       "      <td>[SE]</td>\n",
       "      <td>[SE]</td>\n",
       "      <td>[SE, Defne, Kate, Bing]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Annual Leave</th>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Study Leave</th>\n",
       "      <td>[Defne]</td>\n",
       "      <td>[Chris, Carl, Defne]</td>\n",
       "      <td>[Defne, Despoina]</td>\n",
       "      <td></td>\n",
       "      <td>[SB]</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                       2016-04-18  \\\n",
       "Day                                                        Monday   \n",
       "First Floor Consultant                                         MW   \n",
       "First Floor Registrar (#1028)                                Carl   \n",
       "First Floor Juniors (#1656, 1016)   [Dana, Mike(post-take), Bing]   \n",
       "Manvers Consultant                                      WARDS: MB   \n",
       "Second Floor Registrar (#1238)                              Chris   \n",
       "Second Floor Juniors (#1208, 1138)       [Becky, Despoina, Rosie]   \n",
       "Morning Clinic : Reg                                 ILD : no reg   \n",
       "Afternoon Clinic : Reg                                              \n",
       "Bronchoscopy : Reg                             Han/Bloch : no reg   \n",
       "Clinic Registrar                                                    \n",
       "Nights                                                     [Kate]   \n",
       "Zero Days                                              [SE, Reza]   \n",
       "Annual Leave                                                        \n",
       "Study Leave                                               [Defne]   \n",
       "\n",
       "                                                        2016-04-19  \\\n",
       "Day                                                        Tuesday   \n",
       "First Floor Consultant                                          MW   \n",
       "First Floor Registrar (#1028)                                        \n",
       "First Floor Juniors (#1656, 1016)                     [Dana, Bing]   \n",
       "Manvers Consultant                                       WARDS: MB   \n",
       "Second Floor Registrar (#1238)                                       \n",
       "Second Floor Juniors (#1208, 1138)  [Becky, Mike, Despoina, Rosie]   \n",
       "Morning Clinic : Reg                                   TB : no reg   \n",
       "Afternoon Clinic : Reg                                               \n",
       "Bronchoscopy : Reg                         Elkin/Counihan : no reg   \n",
       "Clinic Registrar                                                     \n",
       "Nights                                                      [Kate]   \n",
       "Zero Days                                               [SE, Reza]   \n",
       "Annual Leave                                                         \n",
       "Study Leave                                   [Chris, Carl, Defne]   \n",
       "\n",
       "                                              2016-04-20  \\\n",
       "Day                                            Wednesday   \n",
       "First Floor Consultant                                MW   \n",
       "First Floor Registrar (#1028)              Carl(on-call)   \n",
       "First Floor Juniors (#1656, 1016)           [Dana, Bing]   \n",
       "Manvers Consultant                             WARDS: MB   \n",
       "Second Floor Registrar (#1238)                     Chris   \n",
       "Second Floor Juniors (#1208, 1138)  [Becky, Mike, Rosie]   \n",
       "Morning Clinic : Reg                   COPD/GEN : no reg   \n",
       "Afternoon Clinic : Reg                  General : no reg   \n",
       "Bronchoscopy : Reg                   Berry/Ross : no reg   \n",
       "Clinic Registrar                                           \n",
       "Nights                                            [Kate]   \n",
       "Zero Days                                           [SE]   \n",
       "Annual Leave                                               \n",
       "Study Leave                            [Defne, Despoina]   \n",
       "\n",
       "                                                               2016-04-21  \\\n",
       "Day                                                              Thursday   \n",
       "First Floor Consultant                                                 MW   \n",
       "First Floor Registrar (#1028)                             Carl(post-take)   \n",
       "First Floor Juniors (#1656, 1016)   [Dana, Defne, Becky(post-take), Bing]   \n",
       "Manvers Consultant                                              WARDS: MB   \n",
       "Second Floor Registrar (#1238)                                      Chris   \n",
       "Second Floor Juniors (#1208, 1138)                [Mike, Despoina, Rosie]   \n",
       "Morning Clinic : Reg                                         MDT : no reg   \n",
       "Afternoon Clinic : Reg                                Fast track : no reg   \n",
       "Bronchoscopy : Reg                                          Wick : no reg   \n",
       "Clinic Registrar                                                            \n",
       "Nights                                                             [Kate]   \n",
       "Zero Days                                                            [SE]   \n",
       "Annual Leave                                                                \n",
       "Study Leave                                                                 \n",
       "\n",
       "                                                 2016-04-22     2016-04-23  \\\n",
       "Day                                                  Friday       Saturday   \n",
       "First Floor Consultant                                   MW                  \n",
       "First Floor Registrar (#1028)                          Carl                  \n",
       "First Floor Juniors (#1656, 1016)   [Dana, Mike(post-take)]                  \n",
       "Manvers Consultant                                WARDS: MB                  \n",
       "Second Floor Registrar (#1238)                        Chris                  \n",
       "Second Floor Juniors (#1208, 1138)        [Despoina, Rosie]                  \n",
       "Morning Clinic : Reg                                                         \n",
       "Afternoon Clinic : Reg                                                       \n",
       "Bronchoscopy : Reg                             Kon : no reg                  \n",
       "Clinic Registrar                                                             \n",
       "Nights                                        [Reza, Becky]  [Reza, Becky]   \n",
       "Zero Days                           [SE, Defne, Kate, Bing]                  \n",
       "Annual Leave                                                                 \n",
       "Study Leave                                            [SB]                  \n",
       "\n",
       "                                       2016-04-24  \n",
       "Day                                        Sunday  \n",
       "First Floor Consultant                             \n",
       "First Floor Registrar (#1028)                      \n",
       "First Floor Juniors (#1656, 1016)                  \n",
       "Manvers Consultant                                 \n",
       "Second Floor Registrar (#1238)                     \n",
       "Second Floor Juniors (#1208, 1138)                 \n",
       "Morning Clinic : Reg                               \n",
       "Afternoon Clinic : Reg                             \n",
       "Bronchoscopy : Reg                                 \n",
       "Clinic Registrar                                   \n",
       "Nights                              [Reza, Becky]  \n",
       "Zero Days                                          \n",
       "Annual Leave                                       \n",
       "Study Leave                                        "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weeklyrota"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "d = datetime.date.today()\n",
    "week_starts = next_weekday(d, 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "rotaname = '%s_weekly_rota.csv' % next_weekday(d, 0)\n",
    "rotaname2 = '%s_weekly_rota.xls' % next_weekday(d, 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "weeklyrota.to_csv(rotaname)\n",
    "weeklyrota.to_excel(rotaname2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Date\n",
       "2016-04-18      Zero\n",
       "2016-04-19      Zero\n",
       "2016-04-20    CLINIC\n",
       "2016-04-21    CLINIC\n",
       "2016-04-22     Night\n",
       "2016-04-23     Night\n",
       "2016-04-24     Night\n",
       "Name: Reza, dtype: object"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Reza']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\">\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>Day</th>\n",
       "      <th>First Floor Consultant</th>\n",
       "      <th>Manvers Consultant</th>\n",
       "      <th>MB</th>\n",
       "      <th>SE</th>\n",
       "      <th>LYH</th>\n",
       "      <th>OMK</th>\n",
       "      <th>WO</th>\n",
       "      <th>MW</th>\n",
       "      <th>...</th>\n",
       "      <th>Simon</th>\n",
       "      <th>Reza</th>\n",
       "      <th>Dana</th>\n",
       "      <th>Defne</th>\n",
       "      <th>Becky</th>\n",
       "      <th>Mike</th>\n",
       "      <th>Despoina</th>\n",
       "      <th>Kate</th>\n",
       "      <th>Rosie</th>\n",
       "      <th>Bing</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2016-04-18</th>\n",
       "      <td>2016-04-18</td>\n",
       "      <td>Monday</td>\n",
       "      <td>MW</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>1</td>\n",
       "      <td>SL</td>\n",
       "      <td>2</td>\n",
       "      <td>PT</td>\n",
       "      <td>2</td>\n",
       "      <td>Night</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-04-19</th>\n",
       "      <td>2016-04-19</td>\n",
       "      <td>Tuesday</td>\n",
       "      <td>MW</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>1</td>\n",
       "      <td>SL</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Night</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-04-20</th>\n",
       "      <td>2016-04-20</td>\n",
       "      <td>Wednesday</td>\n",
       "      <td>MW</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>1</td>\n",
       "      <td>SL</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>SL</td>\n",
       "      <td>Night</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-04-21</th>\n",
       "      <td>2016-04-21</td>\n",
       "      <td>Thursday</td>\n",
       "      <td>MW</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>CLINIC</td>\n",
       "      <td>PT</td>\n",
       "      <td>1</td>\n",
       "      <td>PT</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Night</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2016-04-22</th>\n",
       "      <td>2016-04-22</td>\n",
       "      <td>Friday</td>\n",
       "      <td>MW</td>\n",
       "      <td>WARDS: MB</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Zero</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Night</td>\n",
       "      <td>1</td>\n",
       "      <td>Zero</td>\n",
       "      <td>Night</td>\n",
       "      <td>PT</td>\n",
       "      <td>2</td>\n",
       "      <td>Zero</td>\n",
       "      <td>2</td>\n",
       "      <td>Zero</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows  28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 Date        Day First Floor Consultant Manvers Consultant  \\\n",
       "Date                                                                         \n",
       "2016-04-18 2016-04-18     Monday                     MW          WARDS: MB   \n",
       "2016-04-19 2016-04-19    Tuesday                     MW          WARDS: MB   \n",
       "2016-04-20 2016-04-20  Wednesday                     MW          WARDS: MB   \n",
       "2016-04-21 2016-04-21   Thursday                     MW          WARDS: MB   \n",
       "2016-04-22 2016-04-22     Friday                     MW          WARDS: MB   \n",
       "\n",
       "             MB    SE  LYH  OMK   WO   MW  ...    Simon    Reza Dana Defne  \\\n",
       "Date                                       ...                               \n",
       "2016-04-18  NaN  Zero  NaN  NaN  NaN  NaN  ...      NaN    Zero    1    SL   \n",
       "2016-04-19  NaN  Zero  NaN  NaN  NaN  NaN  ...      NaN    Zero    1    SL   \n",
       "2016-04-20  NaN  Zero  NaN  NaN  NaN  NaN  ...   CLINIC  CLINIC    1    SL   \n",
       "2016-04-21  NaN  Zero  NaN  NaN  NaN  NaN  ...   CLINIC  CLINIC   PT     1   \n",
       "2016-04-22  NaN  Zero  NaN  NaN  NaN  NaN  ...      NaN   Night    1  Zero   \n",
       "\n",
       "            Becky  Mike Despoina   Kate Rosie  Bing  \n",
       "Date                                                 \n",
       "2016-04-18      2    PT        2  Night     2     1  \n",
       "2016-04-19      2     2        2  Night     2     1  \n",
       "2016-04-20      2     2       SL  Night     2     1  \n",
       "2016-04-21     PT     2        2  Night     2     1  \n",
       "2016-04-22  Night    PT        2   Zero     2  Zero  \n",
       "\n",
       "[5 rows x 28 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Date\n",
       "2016-04-18       NaN\n",
       "2016-04-19       NaN\n",
       "2016-04-20    CLINIC\n",
       "2016-04-21    CLINIC\n",
       "2016-04-22       NaN\n",
       "2016-04-23       NaN\n",
       "2016-04-24       NaN\n",
       "Name: Simon, dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Simon']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
